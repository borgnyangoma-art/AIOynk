#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# AIO Creative Hub - Pre-commit Hook
# Runs linting, formatting, and tests before commit

echo "= Running pre-commit checks..."

# Check if Node.js is available
if ! command -v node >/dev/null 2>&1; then
  echo "L Node.js is not installed. Skipping checks."
  exit 0
fi

# Check if lint-staged is installed
if [ ! -f "package.json" ]; then
  echo "   No package.json found. Skipping checks."
  exit 0
fi

# Run lint-staged
npx lint-staged

# Check exit code
if [ $? -ne 0 ]; then
  echo "L Pre-commit checks failed. Please fix the issues above."
  exit 1
fi

echo " Pre-commit checks passed!"

# Run TypeScript compilation check (optional, can be slow)
# echo "=( Running TypeScript compilation check..."
# npm run build --if-present

# Run tests (optional, uncomment to enable)
# echo ">ê Running tests..."
# npm test --if-present

# All checks passed
echo "( Ready to commit!"
